<!DOCTYPE html>
<html>
<head>
    <title>Crypto EMA Trend Analysis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .asset {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .analyses {
            display: flex;
            gap: 20px;
        }
        .analysis {
            flex: 1;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        .uptrend {
            color: green;
        }
        .downtrend {
            color: red;
        }
        .chain-info {
            font-size: 0.8em;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>Crypto Trend Analysis</h1>
    {% for item in analysis %}
    <div class="asset">
        <h2>{{ item.asset }}
            {% if item.chain %}
            <span class="chain-info">(on {{ item.chain }})</span>
            {% endif %}
        </h2>
        <div class="analyses">
            <!-- USDT Analysis -->
            <div class="analysis">
                <h3>{{ item.asset }}/USDT Analysis</h3>
                {% if item.usdt.get('error') %}
                    <p>Error: {{ item.usdt.error }}</p>
                {% else %}
                    <p><small>Data from: {{ item.usdt.exchange }}</small></p>
                    <p>Current Price: ${{ "%.8f"|format(item.usdt.current_price) }}</p>
                    <p>8 EMA: ${{ "%.8f"|format(item.usdt.ema8) }}</p>
                    <p>20 EMA: ${{ "%.8f"|format(item.usdt.ema20) }}</p>
                    <p>USD Trend: <span class="{{ 'uptrend' if item.usdt.is_uptrend else 'downtrend' }}">
                        {{ item.usdt.trend_text }}
                    </span></p>
                    {% if not item.usdt.get('error') %}
                        <p><small>Last updated: {{ item.usdt.timestamp }}</small></p>
                    {% endif %}
                {% endif %}
            </div>
            
            <!-- BTC Analysis -->
            <div class="analysis">
                <h3>{{ item.asset }}/BTC Analysis</h3>
                {% if item.btc.get('error') %}
                    <p>Error: {{ item.btc.error }}</p>
                {% else %}
                    <p><small>Data from: {{ item.btc.exchange }}
                    {% if item.btc.is_calculated %}
                        (calculated from USDT pairs)
                    {% endif %}
                    </small></p>
                    <p>Current Ratio: {{ "%.8f"|format(item.btc.current_price) }} BTC</p>
                    <p>8 EMA: {{ "%.8f"|format(item.btc.ema8) }} BTC</p>
                    <p>20 EMA: {{ "%.8f"|format(item.btc.ema20) }} BTC</p>
                    <p>BTC Trend: <span class="{{ 'uptrend' if item.btc.is_uptrend else 'downtrend' }}">
                        {{ "Outperforming BTC" if item.btc.is_uptrend else "Underperforming BTC" }}
                    </span></p>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</body>
</html> 